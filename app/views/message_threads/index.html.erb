<div class="col border-start border-end" data-controller="messages">
  <div class="mb-3">
    <%= link_to :back, class: "fs-4 text-decoration-none text-black fw-semibold" do%>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 me-3 mb-2" width="30">
        <path fill-rule="evenodd" d="M20.25 12a.75.75 0 01-.75.75H6.31l5.47 5.47a.75.75 0 11-1.06 1.06l-6.75-6.75a.75.75 0 010-1.06l6.75-6.75a.75.75 0 111.06 1.06l-5.47 5.47H19.5a.75.75 0 01.75.75z" clip-rule="evenodd" />
      </svg>
      <span style="position: relative; top: 2px;">Messages</span>
    <% end %>
  </div>
  <%# check this line later--------------- %>
  <% if @new_message_thread_user.present? %>
      <div class="message-thread d-flex py-3 px-3">
        <div class="flex-shirnk-0">
          <% if @new_message_thread_user.avatar.present? %>
            <%= image_tag @new_message_thread_user.avatar, size: "48x48", class: "rounded-circle" %>
          <% else %>
            <%= image_tag "user.png", size: "48x48", class: "rounded-circle" %>
          <% end %>
        </div>
        <div class="flex-grow-1 ms-3">
          <div>
            <span class="fw-bold mr-3"> <%= @new_message_thread_user.display_name %> </span>
            <span class="text-muted">@<%= @new_message_thread_user.username %> </span>
          </div>
        </div>
      </div>
  <% end %>
  <%# --------------------------- %>
  <% @message_threads.each do |message_thread| %>
    <% other_user = message_thread.users.where.not(id: current_user.id).first %>
      <div class="message-thread d-flex py-3 px-3" data-messages-target="messageThread" data-message-thread-id="<%= message_thread.id %>">
        <div class="flex-shirnk-0">
          <% if @new_message_thread_user.avatar.present? %>
            <%= image_tag @new_message_thread_user.avatar, size: "48x48", class: "rounded-circle" %>
          <% else %>
            <%= image_tag "user.png", size: "48x48", class: "rounded-circle" %>
          <% end %>
        </div>
        <div class="flex-grow-1 ms-3">
          <div>
            <span class="fw-bold mr-3"> <%= @new_message_thread_user.display_name %> </span>
            <span class="text-muted">@<%= @new_message_thread_user.username %> </span>
          </div>
        </div>
      </div>
  <% end %>
</div>
<div class="col-7">
  <div class="vh-100 position-relative">
    <%= render "messages", messages: @messages, my_user: current_user %>
    <div class="position-absolute w-100 bottom-0">
      <%= form_with model: Message.new, url: messages_path do |f| %>
        <div class="input-group mb-3">
          <% if @new_message_thread_user.present? %>
            <%= hidden_field_tag :user_id, @new_message_thread_user.id %>
          <% end %>
          <%= f.text_field :body, class: "form-control", placeholder: "Start a new message" %>
          <%= button_tag class: "btn btn-outline-light" do %>
            <%= image_tag "send-message.png", size: "25x25"%>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
